<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–û—Å–æ–±–∏—Å—Ç–∏–π –ö–∞–±—ñ–Ω–µ—Ç –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞</title>
  <link rel="icon" href="1-17ffebdc.ico" type="image/x-icon">
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <style>
    @media (max-width: 640px) {
      .stats-grid {
        grid-template-columns: 1fr;
      }
      .table-container {
        overflow-x: auto;
      }
      table {
        font-size: 0.875rem;
      }
      th, td {
        padding: 0.25rem 0.5rem;
      }
      .top-admins-container {
        flex-direction: column;
        align-items: center;
      }
    }
body {
  background-color: #050608 !important;
  color: #FFFBEF !important;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

#login-section {
  background-color: #121824;
  padding: 40px 30px;
  border-radius: 20px;
  max-width: 400px;
  margin: 60px auto;
  box-shadow: 0 0 30px #1977FDAA;
  text-align: center;
  animation: fadeInUp 1.2s ease forwards;
  opacity: 0;
  transform: translateY(30px);
  font-weight: 700;
  font-size: 1.3rem;
}

#login-section p {
  margin-bottom: 25px;
  color: #FFFBEF;
  font-weight: 600;
  font-size: 1.1rem;
}

.telegram-button-wrapper {
  display: inline-block;
  border-radius: 14px;
  overflow: hidden;
  box-shadow: 0 0 15px #1977FD;
  animation: pulse 3s infinite ease-in-out;
}

.bg-white.p-4.rounded.shadow.mb-6 {
  background-color: #121315 !important;
  color: #FFFBEF;
}

.table-container table {
  width: 100%;
  border-collapse: collapse;
  border-radius: 8px;
  overflow: hidden;
  font-size: 0.9rem;
  background-color: #1a1a1a;
  color: #dcdcdc;
}

.table-container thead {
  background-color: #222;
}

.table-container th {
  text-align: left;
  padding: 10px 12px;
  font-weight: 500;
  color: #b0b0b0;
}

.table-container td {
  padding: 10px 12px;
  border-top: 1px solid #2c2c2c;
}

.table-container tbody tr:nth-child(even) {
  background-color: #1e1e1e;
}

.table-container tbody tr:hover {
  background-color: #2a2a2a;
  transition: background-color 0.2s ease;
}

table {
  background-color: #121315;
  color: #FFFBEF;
  border-color: #2a2d38;
}

.grid.grid-cols-1.sm\:grid-cols-3.gap-4.mb-6.stats-grid > div {
  background-color: #121315 !important;
  color: #FFFBEF !important;
  border-radius: 14px;
}

.bg-white.p-4.rounded.shadow {
  background-color: #121315 !important;
  color: #FFFBEF;
  box-shadow: none !important;
  border-radius: 14px;
}

.grid.grid-cols-1.sm\:grid-cols-3.gap-4.mb-6.stats-grid > div h3 {
  color: #1977FD;
}

.script-menu {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1000;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.menu-button {
  width: 40px;
  height: 40px;
  background-color: #2c2c2c;
  color: white;
  font-size: 22px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

  .menu-category {
  font-weight: bold;
  margin-top: 10px;
  margin-bottom: 5px;
  padding-left: 10px;
  color: #444;
}

.menu-button:hover {
  background-color: #3c3c3c;
}

.script-list {
  display: flex;
  flex-direction: column;
  background-color: #1e1e1e;
  border-radius: 8px;
  padding: 8px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
  max-height: 300px;
  overflow-y: auto;
}

.script-list.hidden {
  display: none !important;
}

.script-item {
  padding: 8px 12px;
  color: #e0e0e0;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s ease;
  font-size: 14px;
  display: block;
  text-decoration: none;
  white-space: nowrap;
}

.script-item:hover {
  background-color: #333;
}
.hidden {
  display: none !important;
}

.script-menu {
  animation: fade-in 0.8s ease-out forwards;
}

h1 {
  font-size: 1.8rem;
  margin-bottom: 1.5rem;
  color: #1977FD;
  text-align: center;
  text-shadow: 0 0 10px rgba(25, 119, 253, 0.5);
}

#logout-btn {
  position: fixed;
  top: 20px;
  right: 20px;
  background-color: #ff4d4d;
  color: white;
  padding: 8px 16px;
  border-radius: 8px;
  cursor: pointer;
  z-index: 1001;
  transition: background-color 0.3s;
  border: none;
  font-weight: bold;
}

#logout-btn:hover {
  background-color: #e60000;
}

@keyframes fade-in {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-fade-in {
  animation: fade-in 0.8s ease-out forwards;
}

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulse {
  0%, 100% {
    box-shadow: 0 0 15px #1977FD;
    transform: scale(1);
  }
  50% {
    box-shadow: 0 0 35px #1977FD;
    transform: scale(1.1);
  }
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤–æ–≥–æ –º–µ–Ω—é —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–æ–≤ */
.super-menu-button {
  width: 40px;
  height: 40px;
  background-color: #1a1a1a;
  color: #357cf0;
  font-size: 22px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  border: 1px solid #357cf0;
}

.super-menu-button:hover {
  background-color: #333;
  transform: scale(1.05);
}

.super-script-list {
  display: flex;
  flex-direction: column;
  background-color: #1e1e1e;
  border-radius: 8px;
  padding: 8px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
  border: 1px solid #357cf0;
  max-height: 300px;
  overflow-y: auto;
}

.super-script-item {
  padding: 8px 12px;
  color: #ffd700;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s ease;
  font-size: 14px;
  display: block;
  text-decoration: none;
  white-space: nowrap;
}

.super-script-item:hover {
  background-color: #333;
  color: #fff;
}

    .anniversary-banner {
    background: linear-gradient(90deg, #2c3e50, #4a6582);
    color: #ecf0f1;
    text-align: center;
    padding: 12px;
    margin-bottom: 20px;
    border-radius: 4px;
    position: relative;
    overflow: hidden;
    border: 1px solid #34495e;
}

.anniversary-banner p {
    margin: 0;
    font-weight: 500;
    font-size: 1rem;
    letter-spacing: 0.5px;
}
   
    /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –Ω–µ–¥–µ–ª–∏ */
    .top-admins-section {
      background: linear-gradient(135deg, #1a2a4f, #2c3e50);
      border: 2px solid #1977FD;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 25px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 5px 25px rgba(25, 119, 253, 0.3);
    }
    
    .top-admins-section::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #1977FD, #00c6ff);
    }
    
    .top-admins-title {
      text-align: center;
      font-size: 1.8rem;
      margin-bottom: 20px;
      color: #FFFBEF;
      text-shadow: 0 0 10px rgba(25, 119, 253, 0.7);
      font-weight: 700;
    }
    
    .top-admins-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 15px;
    }
    
    .admin-card {
      background: rgba(26, 30, 46, 0.8);
      border-radius: 12px;
      width: 180px;
      padding: 15px;
      text-align: center;
      position: relative;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    
    .admin-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(25, 119, 253, 0.4);
    }
    
    .admin-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid;
      margin: 0 auto 12px;
      display: block;
    }
    
    .medal {
      position: absolute;
      top: -10px;
      right: -10px;
      font-size: 2rem;
      filter: drop-shadow(0 3px 5px rgba(0,0,0,0.3));
    }
    
    .admin-name {
      font-weight: 600;
      margin-bottom: 5px;
      color: #FFFBEF;
      font-size: 1.1rem;
    }
    
    .admin-stats {
      font-size: 0.9rem;
      color: #aaa;
    }
    
    .admin-stat-value {
      color: #FFFBEF;
      font-weight: 600;
    }
    
    .week-info {
      text-align: center;
      color: #aaa;
      font-size: 0.9rem;
      margin-top: 10px;
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –º–µ–¥–∞–ª–µ–π */
    @keyframes gold-glow {
      0% { text-shadow: 0 0 5px rgba(255, 215, 0, 0.5); }
      50% { text-shadow: 0 0 20px rgba(255, 215, 0, 0.9); }
      100% { text-shadow: 0 0 5px rgba(255, 215, 0, 0.5); }
    }
    
    @keyframes silver-glow {
      0% { text-shadow: 0 0 5px rgba(192, 192, 192, 0.5); }
      50% { text-shadow: 0 0 20px rgba(192, 192, 192, 0.9); }
      100% { text-shadow: 0 0 5px rgba(192, 192, 192, 0.5); }
    }
    
    @keyframes bronze-glow {
      0% { text-shadow: 0 0 5px rgba(205, 127, 50, 0.5); }
      50% { text-shadow: 0 0 20px rgba(205, 127, 50, 0.9); }
      100% { text-shadow: 0 0 5px rgba(205, 127, 50, 0.5); }
    }
    
    .gold { 
      color: gold;
      border-color: gold;
      animation: gold-glow 2s infinite;
    }
    
    .silver { 
      color: silver;
      border-color: silver;
      animation: silver-glow 2s infinite;
    }
    
    .bronze { 
      color: #cd7f32;
      border-color: #cd7f32;
      animation: bronze-glow 2s infinite;
    }
    
    .normal { 
      color: #1977FD;
      border-color: #1977FD;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800 font-sans">
  <button id="logout-btn" class="hidden">–í–∏–π—Ç–∏</button>

  <div class="container mx-auto p-4">
    <h1 class="text-2xl font-bold mb-4" id="welcome-header">–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ!</h1>
    
    <!-- –ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è –ø–ª–∞—à–∫–∞ -->
    <div id="anniversary-banner" class="anniversary-banner hidden">
      <p>üéâ –°—å–æ–≥–æ–¥–Ω—ñ –º–∏ —Å–≤—è—Ç–∫—É—î–º–æ 3 —Ä—ñ—á–Ω–∏—Ü—é –ø—Ä–æ—î–∫—Ç—É! –ù–µ –∑–∞–±—É–¥—å –ø—Ä–∏–≤—ñ—Ç–∞—Ç–∏ –≤ –≥—Ä—É–ø—ñ –∑ —Ä—ñ—á–Ω–∏—Ü–µ—é! üéâ</p>
    </div>
    
    <!-- –°–µ–∫—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
    <div id="login-section">
      <p>–ë—É–¥—å –ª–∞—Å–∫–∞, —É–≤—ñ–π–¥—ñ—Ç—å —á–µ—Ä–µ–∑ Telegram:</p>
      <div class="telegram-button-wrapper">
        <script async src="https://telegram.org/js/telegram-widget.js?7"
                data-telegram-login="ticket_tracker_UG_bot" 
                data-size="large"
                data-userpic="false"
                data-request-access="write"
                data-onauth="onTelegramAuth(user)">
        </script>
      </div>
    </div>
    
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ–±–æ–∏—Ö –º–µ–Ω—é -->
    <div class="script-menu hidden" id="menuContainer">
<!-- –û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é -->
<div>
  <div class="menu-button" onclick="toggleScripts()">‚â°</div>
  <div class="script-list hidden" id="scriptList">
    
    <div class="menu-category">–°–∫—Ä–∏–ø—Ç–∏</div>
    <a href="script1.1.html" class="script-item">–°–∫—Ä–∏–ø—Ç 1.1</a>
    <a href="script1.2.html" class="script-item">–°–∫—Ä–∏–ø—Ç 1.2</a>
    <a href="script1.3.html" class="script-item">–°–∫—Ä–∏–ø—Ç 1.3</a>
    <a href="script1.4.html" class="script-item">–°–∫—Ä–∏–ø—Ç 1.4</a>
    <a href="script1.5.html" class="script-item">–°–∫—Ä–∏–ø—Ç 1.5</a>
    <a href="script1.6.html" class="script-item">–°–∫—Ä–∏–ø—Ç 1.6</a>

    <div class="menu-category">–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</div>
    <a href="tickets.html" class="script-item">–†–µ–≥–ª–∞–º–µ–Ω—Ç –í—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –¢—ñ–∫–µ—Ç–∏</a>
    <a href="commands.html" class="script-item">–ö–æ–º–∞–Ω–¥–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞</a>

  </div>
</div>

      
      <!-- –ú–µ–Ω—é –¥–ª—è —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–æ–≤ -->
      <div id="superScriptMenu" class="hidden">
        <div class="super-menu-button" onclick="toggleSuperScripts()">‚â°</div>
        <div class="super-script-list hidden" id="superScriptList">
          <a href="test.html" class="super-script-item">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤</a>
          <a href="super-script2.html" class="super-script-item">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ–Ω–ª–∞–π–Ω—É</a>
          <a href="super-script3.html" class="super-script-item">–ö–æ–Ω—Ç—Ä–æ–ª—å —Å–∫–ª–∞–¥—É</a>
        </div>
      </div>
    </div>
    
    <div id="dashboard" class="hidden">
      <!-- –ë–ª–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –Ω–µ–¥–µ–ª–∏ -->
      <div id="top-admins-section" class="top-admins-section hidden">
        <h2 class="top-admins-title">üèÜ –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏ —Ç–∏–∂–Ω—è</h2>
        <div class="week-info" id="week-range">–ü–µ—Ä—ñ–æ–¥: 01.05.2023 - 07.05.2023</div>
        <div class="top-admins-container" id="top-admins-container">
          <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ -->
        </div>
      </div>
      
      <!-- –ë–ª–æ–∫ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ -->
      <div id="admin-notice" class="hidden bg-[#121315] p-6 rounded-xl mb-6 border border-[#1977FD]">
        <h3 class="text-xl font-bold text-[#1977FD] mb-3">üëë –í–∏ - –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º–∏</h3>
        <p class="mb-2">–í–∞—à –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –Ω–µ –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ—é —Ç—ñ–∫–µ—Ç—ñ–≤.</p>
        <p>–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—Å—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –º–µ–Ω—é —Å–∫—Ä–∏–ø—Ç—ñ–≤.</p>
      </div>
      
      <div id="stats-section">
        <h2 class="text-xl font-semibold mb-2">–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h2>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6 stats-grid">
          <div class="bg-white p-4 rounded shadow">
            <h3 class="font-bold mb-2">–ó–∞ –≤—á–æ—Ä–∞</h3>
            <p>–¢—ñ–∫–µ—Ç–∏: <span id="yesterday-tickets">‚Äî</span></p>
            <p>–ß–∞—Å —É –≥—Ä—ñ: <span id="yesterday-time">‚Äî</span></p>
          </div>
          <div class="bg-white p-4 rounded shadow">
            <h3 class="font-bold mb-2">–¢–∏–∂–¥–µ–Ω—å</h3>
            <p>–¢—ñ–∫–µ—Ç–∏: <span id="week-tickets">‚Äî</span></p>
            <p>–ß–∞—Å —É –≥—Ä—ñ: <span id="week-time">‚Äî</span></p>
          </div>
          <div class="bg-white p-4 rounded shadow">
            <h3 class="font-bold mb-2">–ú—ñ—Å—è—Ü—å</h3>
            <p>–¢—ñ–∫–µ—Ç–∏: <span id="month-tickets">‚Äî</span></p>
            <p>–ß–∞—Å —É –≥—Ä—ñ: <span id="month-time">‚Äî</span></p>
          </div>
        </div>

        <div id="contest-rank" class="bg-[#121315] text-white p-4 rounded-xl shadow mb-6 border border-[#1977FD] animate-fade-in">
          <h3 class="text-xl font-bold text-[#1977FD] mb-2">üéâ –ö–æ–Ω–∫—É—Ä—Å "–ö—Ä–∞—â–∏–π –∞–¥–º—ñ–Ω"</h3>
          <p class="mb-2">–¢–∏ –∑–∞—Ä–∞–∑ –Ω–∞ <span id="current-rank" class="font-semibold text-yellow-300">‚Ä¶</span> –º—ñ—Å—Ü—ñ —Å–µ—Ä–µ–¥ —É—Å—ñ—î—ó –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—ó!</p>
          <p class="text-sm text-gray-300">üìÖ –ö–æ–Ω–∫—É—Ä—Å —Ç—Ä–∏–≤–∞—î –¥–æ <span class="text-white">30 —á–µ—Ä–≤–Ω—è</span>. –ë—ñ–ª—å—à–µ —Ç—ñ–∫–µ—Ç—ñ–≤ —ñ –≥–æ–¥–∏–Ω ‚Äî –≤–∏—â–µ —à–∞–Ω—Å –Ω–∞ –ø–µ—Ä–µ–º–æ–≥—É!</p>
        </div>

        <div class="bg-white p-4 rounded shadow mb-6">
          <h3 class="font-bold mb-4">–î–∏–Ω–∞–º—ñ–∫–∞ —Ç—ñ–∫–µ—Ç—ñ–≤ —Ç–∞ —á–∞—Å—É –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ–π –º—ñ—Å—è—Ü—å</h3>
          <canvas id="statsChart" height="150"></canvas>
        </div>

        <div class="bg-white p-4 rounded shadow">
          <h3 class="font-bold mb-2">–î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–Ω—è—Ö:</h3>
          <div class="table-container">
            <table class="min-w-full text-left border-collapse">
              <thead>
                <tr>
                  <th class="border px-2 py-1">–î–∞—Ç–∞</th>
                  <th class="border px-2 py-1">–¢—ñ–∫–µ—Ç–∏</th>
                  <th class="border px-2 py-1">–ß–∞—Å —É –≥—Ä—ñ</th>
                  <th class="border px-2 py-1">–ù–µ–∞–∫—Ç–∏–≤</th>
                </tr>
              </thead>
              <tbody id="daily-stats-body"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const SHEET_ID = '1fobxr4QwD8CLYFaTh2WXNbGwqQ2mWEuQDPkqDzvzkoU'; 
    const API_KEY = 'AIzaSyB3NNELU9ok5mkbHQnBEoOfRtNtPb-y5LU';   
    
    // –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —Å –¥–æ—Å—Ç—É–ø–æ–º
    const allowedAdmins = [
      '@laker_77',
      '@liquid_ug',
      '@Hermaeus_Mora_1679',
      '@c10mm',
      '@noxx_uagtaV',
      '@zhdanovrostyslav'
    ];

    // –°–ø–∏—Å–æ–∫ —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–æ–≤ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ–Ω—é
    const superAdmins = [
      '@laker_77',
      '@liquid_ug',
      '@Hermaeus_Mora_1679',
      '@c10mm'
    ];

    function toggleScripts() {
      const menu = document.getElementById('scriptList');
      const superMenu = document.getElementById('superScriptList');
      
      // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å—É–ø–µ—Ä-–º–µ–Ω—é –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ
      if (!superMenu.classList.contains('hidden')) {
        superMenu.classList.add('hidden');
      }
      
      // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ –º–µ–Ω—é
      menu.classList.toggle('hidden');
    }
    
    function toggleSuperScripts() {
      const menu = document.getElementById('superScriptList');
      const mainMenu = document.getElementById('scriptList');
      
      // –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—É–ø–µ—Ä-–º–µ–Ω—é
      if (!mainMenu.classList.contains('hidden')) {
        mainMenu.classList.add('hidden');
      }
      
      // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ –º–µ–Ω—é
      menu.classList.toggle('hidden');
    }
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('click', function(event) {
      const menuContainer = document.getElementById('menuContainer');
      const scriptList = document.getElementById('scriptList');
      const superScriptList = document.getElementById('superScriptList');
      
      // –ï—Å–ª–∏ –∫–ª–∏–∫ –±—ã–ª –Ω–µ –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º –º–µ–Ω—é
      if (!event.target.closest('.menu-button') && 
          !event.target.closest('.super-menu-button') &&
          !event.target.closest('.script-list') &&
          !event.target.closest('.super-script-list')) {
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ–±–∞ –º–µ–Ω—é
        if (scriptList && !scriptList.classList.contains('hidden')) {
          scriptList.classList.add('hidden');
        }
        if (superScriptList && !superScriptList.classList.contains('hidden')) {
          superScriptList.classList.add('hidden');
        }
      }
    });
    
    async function getSheetData(sheetName) {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${encodeURIComponent(sheetName)}?key=${API_KEY}`;
      const res = await axios.get(url);
      return res.data.values;
    }

    function parseDate(str) {
      const [d, m, y] = str.split('.');
      return new Date(y, m-1, d);
    }

    function formatDate(date) {
      const dd = String(date.getDate()).padStart(2, '0');
      const mm = String(date.getMonth() + 1).padStart(2, '0');
      const yyyy = date.getFullYear();
      return `${dd}.${mm}.${yyyy}`;
    }

    function secondsToHHMMSS(seconds) {
      const h = Math.floor(seconds / 3600);
      const m = Math.floor((seconds % 3600) / 60);
      return h > 0 ? `${h}–≥ ${m}—Ö–≤` : `${m}—Ö–≤`;
    }

    function getDateWithoutTime(date) {
      return new Date(date.getFullYear(), date.getMonth(), date.getDate());
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (—Å –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞ –ø–æ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ)
    function getCurrentWeekRange() {
      const now = new Date();
      const dayOfWeek = now.getDay();
      const diffToMonday = dayOfWeek === 0 ? -6 : 1 - dayOfWeek;
      
      const monday = new Date(now);
      monday.setDate(now.getDate() + diffToMonday);
      
      const sunday = new Date(monday);
      sunday.setDate(monday.getDate() + 6);
      
      return {
        start: formatDate(monday),
        end: formatDate(sunday),
        startDate: monday,
        endDate: sunday
      };
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏
    function getPreviousWeekRange() {
      const now = new Date();
      const dayOfWeek = now.getDay();
      const diffToMonday = dayOfWeek === 0 ? -6 : 1 - dayOfWeek;
      
      const monday = new Date(now);
      monday.setDate(now.getDate() + diffToMonday - 7);
      
      const sunday = new Date(monday);
      sunday.setDate(monday.getDate() + 6);
      
      return {
        start: formatDate(monday),
        end: formatDate(sunday),
        startDate: monday,
        endDate: sunday
      };
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –Ω—É–∂–Ω–æ –ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –Ω–µ–¥–µ–ª–∏
    function shouldRefreshTopAdmins() {
      const lastUpdate = localStorage.getItem('topAdminsLastUpdate');
      if (!lastUpdate) return true;
      
      const now = new Date();
      const lastUpdateDate = new Date(parseInt(lastUpdate));
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª–æ –ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è 23:59 —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏
      const sunday = new Date();
      sunday.setDate(sunday.getDate() + (6 - sunday.getDay()));
      sunday.setHours(23, 59, 0, 0);
      
      return now > sunday && lastUpdateDate < sunday;
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–ø-5 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∑–∞ –Ω–µ–¥–µ–ª—é
    async function getTopAdmins(weekRange) {
      try {
        const [ticketsData, timeData] = await Promise.all([
          getSheetData('–ú–∞–π_2025_—Ç–∞–±–ª–∏—Ü–∞'),
          getSheetData('–í—Ä–µ–º—è_–≤_–∏–≥—Ä–µ')
        ]);

        const ticketsHeaders = ticketsData[0];
        const timeHeaders = timeData[0];
        const nameColIndex = ticketsHeaders.indexOf('–ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞');
        const telegramColIndex = ticketsHeaders.indexOf('Telegram');

        const admins = [];

        ticketsData.slice(1).forEach(row => {
          const name = row[nameColIndex];
          const telegram = row[telegramColIndex];
          
          if (!name || !telegram) return;

          let ticketsSum = 0;
          let timeSecondsSum = 0;

          ticketsHeaders.forEach((header, index) => {
            if (/^\d{2}\.\d{2}\.\d{4}$/.test(header)) {
              const date = parseDate(header);
              if (date >= weekRange.startDate && date <= weekRange.endDate) {
                // –°—É–º–º–∏—Ä—É–µ–º —Ç–∏–∫–µ—Ç—ã
                ticketsSum += parseInt(row[index]) || 0;
                
                // –°—É–º–º–∏—Ä—É–µ–º –≤—Ä–µ–º—è
                const timeRow = timeData.find(r => r[0] === name);
                if (timeRow) {
                  const timeColIndex = timeHeaders.indexOf(header);
                  if (timeColIndex >= 0) {
                    const timeStr = timeRow[timeColIndex];
                    if (timeStr && timeStr !== '–ù') {
                      const [hh, mm, ss] = timeStr.split(':').map(Number);
                      timeSecondsSum += hh * 3600 + mm * 60 + ss;
                    }
                  }
                }
              }
            }
          });

          admins.push({
            name,
            telegram,
            tickets: ticketsSum,
            time: timeSecondsSum,
            timeFormatted: secondsToHHMMSS(timeSecondsSum)
          });
        });

        // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: —Å–Ω–∞—á–∞–ª–∞ –ø–æ —Ç–∏–∫–µ—Ç–∞–º, –∑–∞—Ç–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
        admins.sort((a, b) => {
          if (b.tickets !== a.tickets) return b.tickets - a.tickets;
          return b.time - a.time;
        });

        return admins.slice(0, 5);
      } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Ç–æ–ø—É –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤:', error);
        return [];
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–ø-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
    function renderTopAdmins(admins, weekRange) {
      const container = document.getElementById('top-admins-container');
      container.innerHTML = '';
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–∏–æ–¥–µ
      document.getElementById('week-range').textContent = 
        `–ü–µ—Ä—ñ–æ–¥: ${weekRange.start} - ${weekRange.end}`;
      
      admins.forEach((admin, index) => {
        const card = document.createElement('div');
        card.className = 'admin-card';
        
        let medalClass = 'normal';
        let medal = '';
        
        if (index === 0) {
          medalClass = 'gold';
          medal = 'ü•á';
        } else if (index === 1) {
          medalClass = 'silver';
          medal = 'ü•à';
        } else if (index === 2) {
          medalClass = 'bronze';
          medal = 'ü•â';
        }
        
        card.innerHTML = `
          <div class="${medalClass} medal">${medal}</div>
          <img src="https://t.me/i/userpic/320/${admin.telegram.replace('@', '')}.jpg" 
               alt="${admin.name}" 
               class="admin-avatar ${medalClass}"
               onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(admin.name)}&background=1977FD&color=fff'">
          <div class="admin-name">${admin.name}</div>
          <div class="admin-stats">
            <div>–¢—ñ–∫–µ—Ç–∏: <span class="admin-stat-value">${admin.tickets}</span></div>
            <div>–ß–∞—Å —É –≥—Ä—ñ: <span class="admin-stat-value">${admin.timeFormatted}</span></div>
          </div>
        `;
        
        container.appendChild(card);
      });
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –Ω–µ–¥–µ–ª–∏
    async function loadAndRenderTopAdmins() {
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –Ω–µ–¥–µ–ª—é –¥–ª—è –æ—Ç—á–µ—Ç–∞
      const weekRange = getPreviousWeekRange();
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
      const cacheKey = `topAdmins_${weekRange.start}_${weekRange.end}`;
      const cachedData = localStorage.getItem(cacheKey);
      
      if (cachedData && !shouldRefreshTopAdmins()) {
        const { admins } = JSON.parse(cachedData);
        renderTopAdmins(admins, weekRange);
        return;
      }
      
      // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –∏–ª–∏ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å - –∑–∞–≥—Ä—É–∂–∞–µ–º
      const admins = await getTopAdmins(weekRange);
      
      // –ö—ç—à–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è
      localStorage.setItem(cacheKey, JSON.stringify({ admins }));
      localStorage.setItem('topAdminsLastUpdate', Date.now());
      
      renderTopAdmins(admins, weekRange);
    }

    async function fetchUserStatsByTelegram(telegramUsername) {
      try {
        const ticketsData = await getSheetData('–ú–∞–π_2025_—Ç–∞–±–ª–∏—Ü–∞');
        const timeData = await getSheetData('–í—Ä–µ–º—è_–≤_–∏–≥—Ä–µ');

        const ticketsHeaders = ticketsData[0];
        const telegramColIndex = ticketsHeaders.indexOf('Telegram');
        const nameColIndex = ticketsHeaders.indexOf('–ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞');

        const userTicketsRow = ticketsData.find(row => row[telegramColIndex] === telegramUsername);
        if (!userTicketsRow) {
          alert('–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—ñ —Ç—ñ–∫–µ—Ç—ñ–≤');
          return;
        }

        const userName = userTicketsRow[nameColIndex];

        const timeHeaders = timeData[0];
        const timeNameColIndex = timeHeaders.indexOf('–ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞');
        const userTimeRow = timeData.find(row => row[timeNameColIndex] === userName);
        if (!userTimeRow) {
          alert('–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—ñ —á–∞—Å—É');
          return;
        }

        const today = getDateWithoutTime(new Date());
        const yesterday = new Date(today);
        yesterday.setDate(today.getDate() - 1);

        const dateCols = ticketsHeaders
          .map((h, i) => ({ h, i }))
          .filter(({ h }) => /^\d{2}\.\d{2}\.\d{4}$/.test(h));

        function sumTicketsAndTime(startDate, endDate) {
          let ticketsSum = 0;
          let timeSecondsSum = 0;

          dateCols.forEach(({ h, i }) => {
            const dt = parseDate(h);
            if (dt >= startDate && dt <= endDate) {
              ticketsSum += parseInt(userTicketsRow[i]) || 0;
              const timeColIndex = timeHeaders.indexOf(h);
              if (timeColIndex >= 0) {
                const timeStr = userTimeRow[timeColIndex];
                if (timeStr && timeStr !== '–ù') {
                  const [hh, mm, ss] = timeStr.split(':').map(Number);
                  timeSecondsSum += hh * 3600 + mm * 60 + ss;
                }
              }
            }
          });

          return { ticketsSum, timeSecondsSum };
        }

        const yesterdayStats = sumTicketsAndTime(yesterday, yesterday);
        
        const weekStart = new Date(today);
        weekStart.setDate(today.getDate() - 7);
        const weekStats = sumTicketsAndTime(weekStart, yesterday);
        
        const monthStart = new Date(today);
        monthStart.setDate(today.getDate() - 30);
        const monthStats = sumTicketsAndTime(monthStart, yesterday);

        const allUsers = ticketsData.slice(1).map(row => {
          const name = row[nameColIndex];
          const userTelegram = row[telegramColIndex];

          let totalTickets = 0;
          let totalSeconds = 0;

          dateCols.forEach(({ h, i }) => {
            const dt = parseDate(h);
            if (dt >= monthStart && dt <= yesterday) {
              totalTickets += parseInt(row[i]) || 0;
              const tIndex = timeHeaders.indexOf(h);
              const timeRow = timeData.find(r => r[timeNameColIndex] === name);
              if (timeRow && tIndex >= 0) {
                const timeStr = timeRow[tIndex];
                if (timeStr && timeStr !== '–ù') {
                  const [hh, mm, ss] = timeStr.split(':').map(Number);
                  totalSeconds += hh * 3600 + mm * 60 + ss;
                }
              }
            }
          });

          return { name, telegram: userTelegram, totalTickets, totalSeconds };
        });

        allUsers.sort((a, b) => {
          if (b.totalTickets !== a.totalTickets)
            return b.totalTickets - a.totalTickets;
          return b.totalSeconds - a.totalSeconds;
        });

        const userIndex = allUsers.findIndex(u => u.telegram === telegramUsername);
        if (userIndex !== -1) {
          const place = userIndex + 1;
          document.getElementById('current-rank').innerText = `${place}`;
        }

        document.getElementById('yesterday-tickets').innerText = yesterdayStats.ticketsSum;
        document.getElementById('yesterday-time').innerText = secondsToHHMMSS(yesterdayStats.timeSecondsSum);
        document.getElementById('week-tickets').innerText = weekStats.ticketsSum;
        document.getElementById('week-time').innerText = secondsToHHMMSS(weekStats.timeSecondsSum);
        document.getElementById('month-tickets').innerText = monthStats.ticketsSum;
        document.getElementById('month-time').innerText = secondsToHHMMSS(monthStats.timeSecondsSum);

        const tbody = document.getElementById('daily-stats-body');
        tbody.innerHTML = '';
        let inactiveCount = 0;
        const chartLabels = [];
        const chartTickets = [];
        const chartTimeHours = [];

        dateCols.forEach(({ h, i }) => {
          const dt = parseDate(h);
          if (dt >= monthStart && dt <= yesterday) {
            const dayTickets = parseInt(userTicketsRow[i]) || 0;
            const timeColIndex = timeHeaders.indexOf(h);
            let dayTimeStr = '–ù';
            let dayTimeSeconds = 0;
            if (timeColIndex >= 0) {
              dayTimeStr = userTimeRow[timeColIndex] || '–ù';
              if (dayTimeStr !== '–ù') {
                const [hh, mm, ss] = dayTimeStr.split(':').map(Number);
                dayTimeSeconds = hh * 3600 + mm * 60 + ss;
              }
            }
            if (dayTimeStr === '–ù') inactiveCount++;

            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td class="border px-2 py-1">${h}</td>
              <td class="border px-2 py-1">${dayTickets}</td>
              <td class="border px-2 py-1">${dayTimeStr}</td>
              <td class="border px-2 py-1">${dayTimeStr === '–ù' ? '–¢–∞–∫' : ''}</td>
            `;
            tbody.appendChild(tr);

            chartLabels.push(h);
            chartTickets.push(dayTickets);
            chartTimeHours.push((dayTimeSeconds / 3600).toFixed(2));
          }
        });

        const trTotal = document.createElement('tr');
        trTotal.innerHTML = `
          <td class="border px-2 py-1 font-bold">–£—Å—å–æ–≥–æ –Ω–µ–∞–∫—Ç–∏–≤—ñ–≤</td>
          <td class="border px-2 py-1 font-bold" colspan="3">${inactiveCount}</td>
        `;
        tbody.appendChild(trTotal);

        const ctx = document.getElementById('statsChart').getContext('2d');
        if (window.statsChartInstance) window.statsChartInstance.destroy();

        window.statsChartInstance = new Chart(ctx, {
          type: 'line',
          data: {
            labels: chartLabels,
            datasets: [
              {
                label: '–¢—ñ–∫–µ—Ç–∏',
                data: chartTickets,
                borderColor: 'rgba(59, 130, 246, 1)',
                backgroundColor: 'rgba(59, 130, 246, 0.3)',
                yAxisID: 'yTickets',
                tension: 0.3,
              },
              {
                label: '–ß–∞—Å —É –≥—Ä—ñ (–≥–æ–¥–∏–Ω–∏)',
                data: chartTimeHours,
                borderColor: 'rgba(16, 185, 129, 1)',
                backgroundColor: 'rgba(16, 185, 129, 0.3)',
                yAxisID: 'yTime',
                tension: 0.3,
              }
            ],
          },
          options: {
            responsive: true,
            interaction: {
              mode: 'index',
              intersect: false,
            },
            stacked: false,
            scales: {
              yTickets: {
                type: 'linear',
                display: true,
                position: 'left',
                title: {
                  display: true,
                  text: '–¢—ñ–∫–µ—Ç–∏',
                },
                beginAtZero: true,
              },
              yTime: {
                type: 'linear',
                display: true,
                position: 'right',
                title: {
                  display: true,
                  text: '–ß–∞—Å (–≥–æ–¥–∏–Ω–∏)',
                },
                beginAtZero: true,
                grid: {
                  drawOnChartArea: false,
                },
              },
              x: {
                ticks: {
                  maxRotation: 90,
                  minRotation: 45,
                  maxTicksLimit: 15,
                }
              }
            },
            plugins: {
              legend: {
                position: 'top',
              },
              tooltip: {
                callbacks: {
                  label: ctx => ctx.dataset.label === '–ß–∞—Å —É –≥—Ä—ñ (–≥–æ–¥–∏–Ω–∏)'
                    ? `${ctx.parsed.y} –≥–æ–¥`
                    : ctx.parsed.y,
                }
              }
            }
          },
        });

      } catch (error) {
        console.error(error);
        alert('–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ Google Sheets');
      }
    }

    async function onTelegramAuth(user) {
      const telegramUsername = '@' + user.username;
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
      if (allowedAdmins.includes(telegramUsername)) {
        const userData = {
          username: telegramUsername,
          nickname: user.first_name || user.username,
          isAdmin: true
        };
        localStorage.setItem('tg_auth', JSON.stringify(userData));
        showDashboard(userData.nickname, telegramUsername, true);
        return;
      }

      try {
        const ticketsData = await getSheetData('–ú–∞–π_2025_—Ç–∞–±–ª–∏—Ü–∞');
        const ticketsHeaders = ticketsData[0];
        const telegramColIndex = ticketsHeaders.indexOf('Telegram');
        
        const userTicketsRow = ticketsData.find(row => 
          row[telegramColIndex]?.trim().toLowerCase() === telegramUsername.toLowerCase()
        );
        
        if (userTicketsRow) {
          const userData = {
            username: telegramUsername,
            nickname: userTicketsRow[0],
            isAdmin: false
          };
          localStorage.setItem('tg_auth', JSON.stringify(userData));
          showDashboard(userData.nickname, telegramUsername, false);
        } else {
          localStorage.removeItem('tg_auth');
          alert('–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—ñ. –î–æ—Å—Ç—É–ø –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ.');
          showLoginForm();
        }
      } catch (error) {
        console.error(error);
        alert('–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö');
        showLoginForm();
      }
    }

    function showDashboard(nickname, telegramUsername, isAdmin) {
      document.getElementById('login-section').classList.add('hidden');
      document.getElementById('dashboard').classList.remove('hidden');
      document.getElementById('menuContainer').classList.remove('hidden');
      document.getElementById('logout-btn').classList.remove('hidden');
      document.querySelector('h1').innerText = `–í—ñ—Ç–∞—î–º–æ, ${nickname}!`;
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—É–ø–µ—Ä-–º–µ–Ω—é —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–æ–≤
      if (superAdmins.includes(telegramUsername)) {
        document.getElementById('superScriptMenu').classList.remove('hidden');
      } else {
        document.getElementById('superScriptMenu').classList.add('hidden');
      }
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–ª–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –Ω–µ–¥–µ–ª–∏
      document.getElementById('top-admins-section').classList.remove('hidden');
      loadAndRenderTopAdmins();
      
      if (isAdmin) {
        document.getElementById('admin-notice').classList.remove('hidden');
        document.getElementById('stats-section').classList.add('hidden');
        document.getElementById('contest-rank').classList.add('hidden');
      } else {
        document.getElementById('admin-notice').classList.add('hidden');
        document.getElementById('stats-section').classList.remove('hidden');
        document.getElementById('contest-rank').classList.remove('hidden');
        fetchUserStatsByTelegram(telegramUsername);
      }
    }

    function showLoginForm() {
      document.getElementById('login-section').classList.remove('hidden');
      document.getElementById('dashboard').classList.add('hidden');
      document.getElementById('menuContainer').classList.add('hidden');
      document.getElementById('logout-btn').classList.add('hidden');
      document.querySelector('h1').innerText = '–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ!';
      document.getElementById('top-admins-section').classList.add('hidden');
    }

    function logout() {
      localStorage.removeItem('tg_auth');
      showLoginForm();
    }

    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('logout-btn').addEventListener('click', logout);
      
      const savedAuth = localStorage.getItem('tg_auth');
      if (savedAuth) {
        try {
          const userData = JSON.parse(savedAuth);
          showDashboard(userData.nickname, userData.username, userData.isAdmin || false);
        } catch (e) {
          localStorage.removeItem('tg_auth');
          showLoginForm();
        }
      } else {
        showLoginForm();
      }
    });
  </script>
</body>
</html>
