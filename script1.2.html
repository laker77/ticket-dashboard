<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Скрипт оновлення 1.2</title>
<script async src="https://telegram.org/js/telegram-widget.js?7" 
        data-telegram-login="ticket_tracker_UG_bot" 
        data-size="large"
        data-userpic="false"
        data-request-access="write"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #050608;
    color: #FFFBEF;
  }
  .container {
    display: flex;
    min-height: 100vh;
  }
  nav {
    width: 250px;
    background-color: #121315;
    padding: 20px;
    box-sizing: border-box;
  }
  nav h1 {
    font-size: 1.5em;
    margin-bottom: 1em;
    color: #D6567A;
  }
  nav ul {
    list-style: none;
    padding: 0;
  }
  nav ul li {
    margin-bottom: 1em;
    cursor: pointer;
    color: #FFFBEF;
  }
  nav ul li:hover {
    color: #D6567A;
  }
  main {
    flex-grow: 1;
    padding: 30px;
    box-sizing: border-box;
  }
  h2 {
    color: #D6567A;
    margin-top: 1.5em;
    margin-bottom: 0.5em;
  }
  p, li {
    line-height: 1.5;
  }
  ul {
    padding-left: 20px;
  }
  strong {
    color: #D6567A;
  }
  section {
    margin-bottom: 2em;
  }
  
  /* Стили для авторизации */
  #login-section {
    background-color: #121824;
    padding: 40px 30px;
    border-radius: 20px;
    max-width: 400px;
    margin: 60px auto;
    box-shadow: 0 0 30px #1977FDAA;
    text-align: center;
    animation: fadeInUp 1.2s ease forwards;
    opacity: 0;
    transform: translateY(30px);
    font-weight: 700;
    font-size: 1.3rem;
  }
  #login-section p {
    margin-bottom: 25px;
    color: #FFFBEF;
    font-weight: 600;
    font-size: 1.1rem;
  }
  .telegram-button-wrapper {
    display: inline-block;
    border-radius: 14px;
    overflow: hidden;
    box-shadow: 0 0 15px #1977FD;
    animation: pulse 3s infinite ease-in-out;
  }
  #logout-btn {
    position: fixed;
    top: 20px;
    right: 20px;
    background-color: #ff4d4d;
    color: white;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    z-index: 1001;
    transition: background-color 0.3s;
    border: none;
    font-weight: bold;
  }
  #logout-btn:hover {
    background-color: #e60000;
  }
  .hidden {
    display: none !important;
  }
  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  @keyframes pulse {
    0%, 100% {
      box-shadow: 0 0 15px #1977FD;
      transform: scale(1);
    }
    50% {
      box-shadow: 0 0 35px #1977FD;
      transform: scale(1.1);
    }
  }
</style>
</head>
<body>
  <!-- Кнопка выхода (только для авторизованных) -->
  <button id="logout-btn" class="hidden">Вийти</button>

  <!-- Секция авторизации -->
  <div id="login-section">
    <p>Будь ласка, увійдіть через Telegram:</p>
    <div class="telegram-button-wrapper">
      <script async src="https://telegram.org/js/telegram-widget.js?7"
              data-telegram-login="ticket_tracker_UG_bot" 
              data-size="large"
              data-userpic="false"
              data-request-access="write"
              data-onauth="onTelegramAuth(user)">
      </script>
    </div>
  </div>

  <!-- Основной контент (скрыт по умолчанию) -->
  <div id="content" class="hidden">
    <div class="container">
      <nav>
        <h1>Скрипт оновлення 1.2</h1>
        <ul>
          <li>Батл Пасс</li>
          <li>Зробити подарунок</li>
          <li>Завдання</li>
          <li>Купівля рівня</li>
          <li>Розпорошити</li>
          <li>Секретний пакунок</li>
          <li>Головні призи</li>
          <li>Робота Будівельник</li>
          <li>Нові предмети</li>
          <li>Донат магазин, кейси та зміни</li>
          <li>Додаткові зміни</li>
          <li>Нові авто і де вони</li>
        </ul>
      </nav>
      <main>
        <section>
          <h2>Батл Пасс:</h2>
          <p><strong>VIP Пропуск:</strong><br>
          Є 3 вида пропуска, Стандартний, Діамантовий та Сапфіровий</p>
          <ul>
            <li><strong>Стандартний</strong> - для всіх гравців</li>
            <li><strong>Діамантовий</strong> - відкриває нижню стрічку</li>
            <li><strong>Сапфіровий</strong> - відкриває нижню стрічку та дає +10 рівнів (на картинці +20 що буде змінено на +10)</li>
          </ul>
        </section>

        <section>
          <h2>Зробити подарунок:</h2>
          <p>Є можливість подарувати комусь Батл Пасс, для цього потрібно натиснути на “Зробити подарунок” на Батл Пасс який хочете подарувати та написати статичний ID гравця.</p>
        </section>

        <section>
          <h2>Завдання:</h2>
          <p>Кожне виконане завдання приносить досвід, який накопичується та сприяє підвищенню рівня. Для переходу на новий рівень потрібна певна кількість досвіду, і що вищий рівень, то більше досвіду необхідно.</p>
          <p>На перших рівнях, виконавши всі доступні завдання, можна швидко досягти другого рівня. Проте надалі досвіду може не вистачати, і доведеться чекати наступного дня, щоб знову виконати завдання та підняти рівень.</p>
          <p>Завдання оновлюється кожного дня після рестарту о 5:10</p>
          <p>Є можливість пропуск одного завдання в день (натиснувши на стрілку біля завдання)</p>
          <p>Завдання діляться на 3 категорії:</p>
          <ul>
            <li>Легкі (200, 400, 600 досвіду після виконання)</li>
            <li>Середні (900, 1300 досвіду після виконання)</li>
            <li>Тяжкі (2500 досвіду після виконання)</li>
            <li>Фракційна - видається гравцям які перебувають в фракціях (500 досвіду після виконання)</li>
          </ul>
          <p>Завдання кожного дня міняються рандомно у всіх гравців вони різні.</p>
          <p>Є <strong>“ЩАСЛИВИЙ КВЕСТ”</strong> — для його виконання треба просто забрати приз в Батл Пасс.</p>
        </section>

        <section>
          <h2>Купівля рівня:</h2>
          <p>Гравець може придбати рівень за карбованці, і після покупки він автоматично піднімається на один рівень.</p>
          <p>Вартість підвищення рівня змінюється залежно від того, на якому рівні ти знаходишся. Ціна оновлюється кожні 10 рівнів.</p>
        </section>

        <section>
          <h2>Розпорошити:</h2>
          <p>Кожен предмет можна розпорошити, якщо ви не плануєте його використовувати. У результаті гравець отримує додатковий досвід.</p>
          <p>Сума досвіду, яку гравець отримує за розпорошення предмету, залежить від його цінності. Чим дорожчий або рідкісніший предмет, тим більше досвіду можна отримати.</p>
        </section>

        <section>
          <h2>Секретний пакунок:</h2>
          <p>Секретні пакунки бувають двох типів: з грошима та з автівкою. Пакунки не зберігаються в інвентарі і їх можна відкрити тільки коли вони випадають як винагорода.</p>
          <p>Автівки, що можна отримати з пакунків, звичайні, а найкраща з них — Ubermacht W8 Gran Coupe.</p>
          <p>Пакунок можна розпорошити тільки до його відкриття, а не після того, як приз буде виданий.</p>
        </section>

        <section>
          <h2>Головні призи:</h2>
          <ul>
            <li>Верхня стрічка - Porsche Panamera Turbo '17</li>
            <li>Нижня стрічка - Mercedes-Benz G63</li>
            <li>Секретний пакунок - BMW М8 Gran Coupe</li>
          </ul>
        </section>

        <section>
          <h2>Робота Будівельник:</h2>
          <p>Локацію можна знайти в телефоні “GPS Локатор” - “Роботи” - “Будівельник”.</p>
          <p>Для початку роботи потрібно підійти до NPC, спочатку взяти молоток, а потім влаштуватись на роботу. Після цього видається форма і треба підійти до мітки, яка показується на міні-карті.</p>
          <p>Щоб міні-гра почалась, потрібно взяти молоток в руки та натиснути клавішу “Е”.</p>
          <p>Міні-гра складається з того, що потрібно натиснути клавішу “Пробел” коли зелений кружок далі від центру.</p>
          <p>Спочатку зарплата складає 120 ігрової валюти за кожну мітку. Чим більше міток ви проходите, тим більше нараховується зарплата, зростаючи %.</p>
          <p>Щоб досягти 25%, потрібно пройти 80 міток, після чого зарплата досягне 180 ігрової валюти.</p>
          <ul>
            <li>До 25% - 80 міток - 180 ЗП</li>
            <li>До 50% - 100 міток - 220 ЗП</li>
            <li>До 75% - 120 міток - 250 ЗП</li>
            <li>До 100% - 150 міток - 300 ЗП</li>
          </ul>
        </section>

        <section>
          <h2>Нові предмети:</h2>
          <p>До гри додано предмет, який дозволяє зняти всі зірки розшуку. Цей предмет можна отримати лише в Батл Пассі. Він потрапляє в інвентар у вигляді документа, і при використанні знімається розшук.</p>
          <p>Також додані знижки на ЛСК, Тату-Салоні, Перукарні, 24/7, Закусочна, Магазин одягу, Риболовний магазин, Магазин зброї, Магазин масок.</p>
          <p>Знижок є 5, 7 та 10%.</p>
          <p>Знижки можна отримати в Батл Пассі. Вони не є окремими предметами в інвентарі, а активуються автоматично, якщо ви маєте знижку та здійснюєте покупку в одному з вищезгаданих магазинів.</p>
        </section>

        <section>
          <h2>Донат магазин, кейси та зміни:</h2>
          <h3>Донат магазин</h3>
          <p>До донатного магазину було додано нові речі та автомобілі такі як:</p>
          <ul>
            <li>BMW X7 - 5900 донату</li>
            <li>Koenigsegg Gemera - 11249 донату</li>
            <li>Ferrari SF90 2024 - 8200 донату</li>
            <li>Bugatti Divo - 13689 донату</li>
            <li>Lamborghini Aventador LP770 - 10890 донату</li>
          </ul>

          <h3>Кейси:</h3>
          <p>Додано 2 нових кейса:</p>
          <ul>
            <li>Фортуна (який замінить кейс за 5 годин в грі)</li>
            <li>Останній шанс</li>
          </ul>
          <p>Нові ціни на кейси та послуги за карбованці:</p>
          <p><strong>В нових кейсах чоловіки бачать чоловічі речі, а жінки — жіночі.</strong></p>
        </section>

        <section>
          <h2>Додаткові зміни:</h2>
          <ul>
            <li>На всіх роботах тепер заробіток підвищений: Лісоруб, Водій автобусів, Інкасатор, Таксист.</li>
            <li>В усіх фракціях тепер гравці отримують більше ЗП ніж було. Наприклад, лідер ФІБ заробляв 10.000, а тепер 20.800.</li>
            <li>Ціни на тюнінг зменшились для кожного авто.</li>
            <li>Ціни на деякі авто в автосалоні були змінені.</li>
            <li>В тату салоні з'явились Black Works на руках, ногах, шиї та торсі.</li>
            <li>Авто інкасаторів змінено.</li>
            <li>В кожній державній фракції, мафії та бандах додано можливість брати зі складу свої бронежилети, в державних фракціях додалась можливість для ГОВки. В бандах — для всіх.</li>
            <li>Налаштувати видачу бронежилетів по рангу може лідер.</li>
            <li>В бандах бронежилети — 50%. Коли гравець бере бронік, зі складу забирається 50 одиниць боєприпасів.</li>
            <li>В бандах та мафіях є “Спорядження” - “Бронежилет”.</li>
            <li>В звичайних магазинах доданий новий одяг, який можна придбати за ігрову валюту. В залежності від вигляду одягу, розподілений по класам магазину: Люкс, Економ, Стандарт.</li>
            <li>Фон під час авторизації змінений.</li>
          </ul>
        </section>

        <section>
          <h2>Нові авто і де вони:</h2>
          <p>Нові автомобілі, де вони знаходяться та їх ціна:</p>
          <ul>
            <li>Toyota Land Cruiser 300 - 1.450.000</li>
            <li>Volkswagen Golf GTI - 190.000</li>
            <li>Ford Mustang - 550.000</li>
            <li>Audi RS7 2021 - 1.850.000</li>
            <li>Porsche Cayenne - 850.000</li>
            <li>BMW М850 Coupe - 1.700.000</li>
            <li>Mercedes-Benz С300 - 850.000</li>
            <li>Mercedes-Benz GLE 63 - 1.250.000</li>
          </ul>
          <p><strong>Всі вони в люксовому магазині!</strong></p>
        </section>

        <section>
          <p><strong>!!! Розповсюдження цього скрипта призведе до ЧСП проектів, скрипт маєте бачити ВИ і тільки ВИ !!!</strong></p>
        </section>
      </main>
    </div>
  </div>

  <script>
    const SHEET_ID = '1fobxr4QwD8CLYFaTh2WXNbGwqQ2mWEuQDPkqDzvzkoU';
    const API_KEY = 'AIzaSyB3NNELU9ok5mkbHQnBEoOfRtNtPb-y5LU';

    async function getSheetData(sheetName) {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${encodeURIComponent(sheetName)}?key=${API_KEY}`;
      const res = await axios.get(url);
      return res.data.values;
    }

    async function onTelegramAuth(user) {
      const telegramUsername = '@' + user.username;
      
      try {
        const ticketsData = await getSheetData('Май_2025_таблица');
        const ticketsHeaders = ticketsData[0];
        const telegramColIndex = ticketsHeaders.indexOf('Telegram');
        
        const userTicketsRow = ticketsData.find(row => 
          row[telegramColIndex]?.trim().toLowerCase() === telegramUsername.toLowerCase()
        );
        
        if (userTicketsRow) {
          // Сохраняем данные пользователя
          const userData = {
            username: telegramUsername,
          };
          localStorage.setItem('tg_auth', JSON.stringify(userData));
          
          // Показываем контент
          showContent();
        } else {
          // Если пользователь не найден
          localStorage.removeItem('tg_auth');
          alert('Користувача не знайдено в таблиці. Доступ заборонено.');
          showLoginForm();
        }
      } catch (error) {
        console.error(error);
        alert('Помилка під час завантаження даних');
        showLoginForm();
      }
    }

    // Функция для показа контента
    function showContent() {
      document.getElementById('login-section').classList.add('hidden');
      document.getElementById('content').classList.remove('hidden');
      document.getElementById('logout-btn').classList.remove('hidden');
    }

    // Функция для показа формы входа
    function showLoginForm() {
      document.getElementById('login-section').classList.remove('hidden');
      document.getElementById('content').classList.add('hidden');
      document.getElementById('logout-btn').classList.add('hidden');
    }

    // Функция выхода
    function logout() {
      localStorage.removeItem('tg_auth');
      showLoginForm();
    }

    // Проверка сохраненной сессии при загрузке
    document.addEventListener('DOMContentLoaded', function() {
      // Добавляем обработчик для кнопки выхода
      document.getElementById('logout-btn').addEventListener('click', logout);
      
      // Проверяем сохраненную сессию
      const savedAuth = localStorage.getItem('tg_auth');
      if (savedAuth) {
        try {
          showContent();
        } catch (e) {
          localStorage.removeItem('tg_auth');
          showLoginForm();
        }
      }
    });
  </script>
</body>
</html>
