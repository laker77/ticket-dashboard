<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ú–∞–≥–∞–∑–∏–Ω –±–∞–ª—ñ–≤ | Ukraine GTA 5 RP</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <style>
    :root {
      --bg-primary: #0A0A0A;
      --bg-secondary: #111111;
      --bg-tertiary: #1A1A1A;
      --border-color: #2A2A2A;
      --text-primary: #FAFAFA;
      --text-secondary: #A1A1A1;
      --text-tertiary: #6B6B6B;
      --accent-blue: #3B82F6;
      --accent-green: #10B981;
      --accent-yellow: #F59E0B;
      --accent-red: #EF4444;
      --accent-purple: #8B5CF6;
      --shadow: 0 4px 24px rgba(0, 0, 0, 0.4);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: var(--bg-primary); color: var(--text-primary); font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; min-height: 100vh; overflow-x: hidden; transition: var(--transition); }
    .hidden { display: none !important; }

    /* ====================== –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ====================== */
    #login-section, #access-denied-section {
      position: fixed; inset: 0; background: var(--bg-primary); display: flex; align-items: center; justify-content: center; z-index: 3000;
    }
    .login-container, .access-denied-content {
      background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 2.5rem 2rem; max-width: 460px; width: 90%; text-align: center; box-shadow: var(--shadow);
    }
    .login-logo {
      width: 80px; height: 80px; margin: 0 auto 1.5rem; background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.2rem; color: white;
    }
    .login-title { font-size: 1.8rem; margin-bottom: .5rem; }
    .login-subtitle { color: var(--text-secondary); margin-bottom: 2rem; }
    .telegram-button-wrapper { display: inline-block; border-radius: .75rem; overflow: hidden; box-shadow: 0 0 20px rgba(59,130,246,.4); transition: var(--transition); }
    .telegram-button-wrapper:hover { transform: scale(1.04); }
    .access-denied-icon { font-size: 4rem; color: var(--accent-red); margin-bottom: .5rem; }
    .back-to-login-btn {
      margin-top: 1rem; background: var(--accent-red); color: white; padding: .6rem 1.5rem; border-radius: .5rem; cursor: pointer; border: none; font-weight: 600; transition: var(--transition);
    }
    .back-to-login-btn:hover { background: #DC2626; }
    #logout-btn {
      position: fixed; top: 1rem; right: 1rem; background: var(--accent-red); color: white; padding: .5rem 1rem; border-radius: .5rem; font-weight: 600; cursor: pointer; z-index: 1001; transition: var(--transition); border: none;
    }
    #logout-btn:hover { background: #DC2626; }

    /* ====================== –¢–û–ü-–ë–ê–† ====================== */
    .top-bar {
      position: fixed; top: 0; left: 0; right: 0; height: 60px; background: var(--bg-secondary); border-bottom: 1px solid var(--border-color); display: flex; align-items: center; justify-content: space-between; padding: 0 1.5rem; z-index: 999; backdrop-filter: blur(8px);
    }
    .top-bar-left { display: flex; align-items: center; gap: 1rem; }
    .top-bar-title { font-size: 0.875rem; font-weight: 600; }
    .top-bar-right { display: flex; align-items: center; gap: 0.75rem; }
    .user-info { display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 1rem; background: var(--bg-tertiary); border-radius: 8px; border: 1px solid var(--border-color); }
    .user-balance { font-size: 0.875rem; font-weight: 600; }
    .balance-amount { color: var(--accent-yellow); }

    /* ====================== –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ ====================== */
    .main-content {
      margin-top: 60px; padding: 2rem 1.5rem; min-height: calc(100vh - 60px); max-width: 1400px; margin-left: auto; margin-right: auto;
    }
    .banner {
      background: linear-gradient(135deg, var(--accent-blue) 0%, #1D4ED8 100%); border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem; text-align: center; position: relative; overflow: hidden;
    }
    .banner-content { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem; position: relative; z-index: 1; }
    .banner-text { flex: 1; min-width: 200px; text-align: left; }
    .banner-title { font-size: 1.25rem; font-weight: 700; color: white; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem; }
    .banner-description { font-size: 0.875rem; color: rgba(255, 255, 255, 0.9); }
    .banner-link { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1.5rem; background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); color: white; border-radius: 8px; font-size: 0.875rem; font-weight: 600; text-decoration: none; border: 1px solid rgba(255, 255, 255, 0.3); transition: var(--transition); }
    .banner-link:hover { background: rgba(255, 255, 255, 0.3); transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2); }

    .shop-header { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 2rem; margin-bottom: 2rem; text-align: center; }
    .shop-logo { display: flex; align-items: center; justify-content: center; gap: 1rem; margin-bottom: 1rem; }
    .shop-logo i { font-size: 2.5rem; color: var(--accent-yellow); }
    .shop-title { font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem; }
    .shop-subtitle { font-size: 1rem; color: var(--text-secondary); max-width: 800px; margin: 0 auto; line-height: 1.6; }

    .categories { display: flex; justify-content: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 0.5rem; }
    .category-btn { padding: 0.75rem 1.5rem; background: var(--bg-secondary); border: 1px solid var(--border-color); color: var(--text-secondary); border-radius: 8px; font-size: 0.875rem; font-weight: 500; cursor: pointer; transition: var(--transition); }
    .category-btn.active, .category-btn:hover { background: var(--accent-blue); color: white; border-color: var(--accent-blue); }

    .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
    .product-card { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; overflow: hidden; transition: var(--transition); position: relative; }
    .product-card:hover { transform: translateY(-5px); border-color: var(--accent-blue); box-shadow: 0 8px 32px rgba(59, 130, 246, 0.15); }
    .product-image { height: 200px; background: var(--bg-tertiary); display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; }
    .product-image img { width: 100%; height: 100%; object-fit: cover; }
    .product-image-placeholder { display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-tertiary); font-size: 3rem; }
    .product-image-placeholder span { font-size: 0.875rem; margin-top: 0.5rem; }
    .product-info { padding: 1.5rem; }
    .product-name { font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; }
    .product-description { font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem; line-height: 1.5; min-height: 40px; }
    .product-price { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
    .price { font-weight: 700; color: var(--accent-yellow); font-size: 1.25rem; }
    .buy-btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.75rem 1.5rem; background: var(--accent-blue); color: white; font-size: 0.875rem; font-weight: 600; border-radius: 8px; border: none; cursor: pointer; transition: var(--transition); width: 100%; }
    .buy-btn:hover { background: #2563EB; transform: translateY(-2px); box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4); }
    .buy-btn:disabled { background: var(--text-tertiary); cursor: not-allowed; transform: none; box-shadow: none; }
    .product-stock { position: absolute; top: 1rem; right: 1rem; background: var(--accent-green); color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: 600; }
    .product-stock.low { background: var(--accent-red); }

    .purchase-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 2000; align-items: center; justify-content: center; }
    .purchase-modal.active { display: flex; }
    .modal-content { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 2rem; max-width: 500px; width: 90%; box-shadow: var(--shadow); }
    .modal-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem; }
    .modal-title { font-size: 1.25rem; font-weight: 600; }
    .close-modal { background: transparent; border: none; color: var(--text-secondary); font-size: 1.25rem; cursor: pointer; transition: var(--transition); }
    .close-modal:hover { color: var(--text-primary); }
    .modal-message { font-size: 0.875rem; color: var(--text-secondary); line-height: 1.6; }
    .modal-footer { display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1.5rem; }
    .cancel-btn, .confirm-btn { padding: 0.75rem 1.5rem; border-radius: 8px; font-size: 0.875rem; font-weight: 500; cursor: pointer; transition: var(--transition); border: none; }
    .cancel-btn { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); }
    .cancel-btn:hover { background: var(--border-color); }
    .confirm-btn { background: var(--accent-green); color: white; }
    .confirm-btn:hover { background: #059669; }

    /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
    .notification {
      position: fixed;
      top: 80px;
      right: 20px;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      color: white;
      font-weight: 500;
      z-index: 10000;
      box-shadow: var(--shadow);
      transform: translateX(120%);
      transition: transform 0.3s ease;
    }
    .notification.show {
      transform: translateX(0);
    }
    .notification.success {
      background: var(--accent-green);
    }
    .notification.error {
      background: var(--accent-red);
    }
    .notification.warning {
      background: var(--accent-yellow);
    }

    /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
    .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,.3); border-radius: 50%; border-top-color: #fff; animation: spin 1s ease-in-out infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }

    footer { text-align: center; padding: 2rem 0 1rem; color: var(--text-secondary); margin-top: 3rem; border-top: 1px solid var(--border-color); }
    .back-to-top { position: fixed; bottom: 2rem; right: 2rem; width: 48px; height: 48px; background: var(--accent-blue); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; opacity: 0; transform: translateY(20px); transition: var(--transition); z-index: 100; box-shadow: var(--shadow); border: none; }
    .back-to-top:hover { background: #2563EB; }
    .back-to-top.visible { opacity: 1; transform: translateY(0); }

    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    @media (max-width: 768px) {
      .top-bar { padding: 0 1rem; }
      .main-content { padding: 1.5rem 1rem; margin-top: 60px; }
      .banner-content { flex-direction: column; text-align: center; }
      .shop-title { font-size: 1.5rem; }
      .products-grid { grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); }
      .modal-footer { flex-direction: column; }
    }
  </style>
</head>
<body>

  <!-- ====================== –ï–ö–†–ê–ù –í–•–û–î–£ ====================== -->
  <div id="login-section">
    <div class="login-container">
      <div class="login-logo"><i class="fab fa-telegram-plane"></i></div>
      <h1 class="login-title">–í—Ö—ñ–¥ —á–µ—Ä–µ–∑ Telegram</h1>
      <p class="login-subtitle">–ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –º–∞–≥–∞–∑–∏–Ω—É –±–∞–ª—ñ–≤</p>
      <div class="telegram-button-wrapper">
        <script async src="https://telegram.org/js/telegram-widget.js?22"
                data-telegram-login="ticket_tracker_UG_bot"
                data-size="large"
                data-userpic="false"
                data-request-access="write"
                data-onauth="onTelegramAuth(user)"></script>
      </div>
    </div>
  </div>

  <!-- ====================== –í–Ü–î–ú–û–í–ê –£ –î–û–°–¢–£–ü–Ü ====================== -->
  <div id="access-denied-section" class="hidden">
    <div class="access-denied-content">
      <div class="access-denied-icon"><i class="fas fa-ban"></i></div>
      <h1 class="login-title">–î–û–°–¢–£–ü –ó–ê–ë–û–†–û–ù–ï–ù–û</h1>
      <p class="login-subtitle">–í–∞—à Telegram‚Äë–∞–∫–∞—É–Ω—Ç –Ω–µ –º–∞—î –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø—É.</p>
      <button class="back-to-login-btn" onclick="logout()">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –≤—Ö–æ–¥—É</button>
    </div>
  </div>

  <button id="logout-btn" class="hidden" onclick="logout()">–í–∏–π—Ç–∏</button>

  <!-- ====================== –¢–û–ü-–ë–ê–† ====================== -->
  <div class="top-bar">
    <div class="top-bar-left">
      <div class="top-bar-title">–ú–∞–≥–∞–∑–∏–Ω –±–∞–ª—ñ–≤ Ukraine GTA 5 RP</div>
    </div>
    <div class="top-bar-right">
      <div class="user-info">
        <div class="user-balance">–ë–∞–ª–∞–Ω—Å: <span class="balance-amount" id="user-balance">0</span> –±–∞–ª—ñ–≤</div>
      </div>
    </div>
  </div>

  <!-- ====================== –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û ====================== -->
  <div class="purchase-modal" id="purchase-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –ø–æ–∫—É–ø–∫–∏</h3>
        <button class="close-modal" id="close-modal"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <p class="modal-message" id="modal-message">
          –í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∫—É–ø–∏—Ç–∏ <strong id="product-name-modal">–¢–æ–≤–∞—Ä</strong> –∑–∞ <strong id="product-price-modal">0</strong> –±–∞–ª—ñ–≤?
        </p>
      </div>
      <div class="modal-footer">
        <button class="cancel-btn" id="cancel-purchase">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
        <button class="confirm-btn" id="confirm-purchase">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button>
      </div>
    </div>
  </div>

  <!-- ====================== –û–°–ù–û–í–ù–ò–ô –ö–û–ù–¢–ï–ù–¢ ====================== -->
  <div class="main-content hidden" id="mainContent">
    <div class="banner">
      <div class="banner-content">
        <div class="banner-text">
          <h2 class="banner-title"><i class="fas fa-gem" style="color: #F59E0B;"></i> –ú–∞–≥–∞–∑–∏–Ω –±–∞–ª—ñ–≤ Ukraine GTA 5 RP</h2>
          <p class="banner-description">–û–±–º—ñ–Ω—é–π—Ç–µ —Å–≤–æ—ó –±–∞–ª–∏ –Ω–∞ –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω—ñ –ø—Ä–µ–¥–º–µ—Ç–∏ —Ç–∞ –ø—Ä–∏–≤—ñ–ª–µ—ó –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ</p>
        </div>
        <a href="#" class="banner-link"><i class="fas fa-question-circle"></i> –Ø–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –±–∞–ª–∏?</a>
      </div>
    </div>

    <div class="shop-header">
      <div class="shop-logo">
        <i class="fas fa-coins"></i>
        <h1 class="shop-title">–ú–∞–≥–∞–∑–∏–Ω –±–∞–ª—ñ–≤ Ukraine GTA 5 RP</h1>
      </div>
      <p class="shop-subtitle">
        –û–±–º—ñ–Ω—é–π—Ç–µ –±–∞–ª–∏, –æ—Ç—Ä–∏–º–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥—É –ø—Ä–æ–µ–∫—Ç—É, –Ω–∞ –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω—ñ –ø—Ä–µ–¥–º–µ—Ç–∏ —Ç–∞ –ø—Ä–∏–≤—ñ–ª–µ—ó. 
        –ü—ñ—Å–ª—è –ø–æ–∫—É–ø–∫–∏ –∑–∞—è–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—ó –¥–ª—è –≤–∏–ø–ª–∞—Ç–∏.
      </p>
    </div>

    <div class="categories">
      <button class="category-btn active" data-category="all">–í—Å—ñ —Ç–æ–≤–∞—Ä–∏</button>
      <button class="category-btn" data-category="transport">–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</button>
      <button class="category-btn" data-category="clothing">–û–¥—è–≥</button>
      <button class="category-btn" data-category="accessories">–ê–∫—Å–µ—Å—É–∞—Ä–∏</button>
    </div>

    <div class="products-grid" id="products-grid"></div>

    <footer>
      <p class="footer-logo">Ukraine GTA 5 RolePlay</p>
      <p class="copyright">¬© 2025 Ukraine GTA 5 RolePlay | –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—è —Å–µ—Ä–≤–µ—Ä–∞</p>
    </footer>
  </div>

  <button class="back-to-top" id="backToTop"><i class="fas fa-arrow-up"></i></button>

  <!-- ====================== –°–ö–†–ò–ü–¢–ò ====================== -->
  <script>
    // ==================== –ö–û–ù–§–Ü–ì GOOGLE SHEETS ====================
    const SHEET_ID = '1fobxr4QwD8CLYFaTh2WXNbGwqQ2mWEuQDPkqDzvzkoU'; 
    const API_KEY = 'AIzaSyB3NNELU9ok5mkbHQnBEoOfRtNtPb-y5LU';   
    const BALANCE_SHEET_NAME = '–ë–∞–ª–∞–Ω—Å–∏';

    // ==================== Telegram Auth ====================
    async function onTelegramAuth(user) {
      if (!user?.username) return showAccessDenied();
      const tgUsername = '@' + user.username;

      try {
        console.log('–ù–∞—á–∞–ª–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è:', tgUsername);
        
        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª–∏—Å—Ç–∞ –±–∞–ª–∞–Ω—Å–æ–≤
        const balanceData = await getSheetData(BALANCE_SHEET_NAME);
        console.log('–î–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã:', balanceData);
        
        if (!balanceData || balanceData.length < 2) {
          throw new Error('–¢–∞–±–ª–∏—Ü–∞ –±–∞–ª–∞–Ω—Å–æ–≤ –ø—É—Å—Ç–∞ –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö');
        }

        const headers = balanceData[0];
        console.log('–ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã:', headers);
        
        // –ì–∏–±–∫–∏–π –ø–æ–∏—Å–∫ –∫–æ–ª–æ–Ω–æ–∫ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –≤–∞—Ä–∏–∞–Ω—Ç–∞–º –Ω–∞–∑–≤–∞–Ω–∏–π
        const findColumnIndex = (possibleNames) => {
          for (let name of possibleNames) {
            const index = headers.findIndex(h => 
              h && h.toString().toLowerCase().includes(name.toLowerCase())
            );
            if (index !== -1) return index;
          }
          return -1;
        };

        // –ò—â–µ–º –∫–æ–ª–æ–Ω–∫–∏
        const nameCol = findColumnIndex(['–∏–º—è', '–∏–≥—Ä–æ–≤–æ–π', '–Ω–∏–∫', 'name', 'nick']);
        const staticIdCol = findColumnIndex(['static', '—Å—Ç–∞—Ç–∏–∫', 'id']);
        const tgCol = findColumnIndex(['telegram', '—Ç–µ–ª–µ–≥—Ä–∞–º', 'tg', 'username']);
        const balanceCol = findColumnIndex(['–±–∞–ª', '–±–∞–ª–ª', 'balance', 'score', 'points', '–∫—ñ–ª—å–∫—ñ—Å—Ç—å']);
        
        console.log('–ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –∫–æ–ª–æ–Ω–æ–∫:', { 
          nameCol, 
          staticIdCol, 
          tgCol, 
          balanceCol,
          name: headers[nameCol],
          tg: headers[tgCol],
          balance: headers[balanceCol]
        });

        if (tgCol === -1) {
          throw new Error('–ö–æ–ª–æ–Ω–∫–∞ Telegram –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏: ' + headers.join(', '));
        }
        if (balanceCol === -1) {
          throw new Error('–ö–æ–ª–æ–Ω–∫–∞ —Å –±–∞–ª–ª–∞–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏: ' + headers.join(', '));
        }

        // –ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ Telegram
        let userRow = null;
        let userRowIndex = -1;

        for (let i = 1; i < balanceData.length; i++) {
          const row = balanceData[i];
          if (row[tgCol] && row[tgCol].toString().trim().toLowerCase() === tgUsername.toLowerCase()) {
            userRow = row;
            userRowIndex = i;
            break;
          }
        }

        console.log('–ù–∞–π–¥–µ–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', userRow);
        console.log('–ò–Ω–¥–µ–∫—Å —Å—Ç—Ä–æ–∫–∏:', userRowIndex);

        if (!userRow) {
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–∫–∏–µ Telegram –µ—Å—Ç—å –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
          const availableTg = balanceData.slice(1)
            .map(row => row[tgCol])
            .filter(tg => tg && tg.toString().trim())
            .map(tg => tg.toString().trim());
          
          console.log('–î–æ—Å—Ç—É–ø–Ω—ã–µ Telegram –≤ —Ç–∞–±–ª–∏—Ü–µ:', availableTg);
          throw new Error(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${tgUsername} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Telegram –∑–∞–ø–æ–ª–Ω–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ. –î–æ—Å—Ç—É–ø–Ω—ã–µ: ${availableTg.join(', ')}`);
        }

        const userBalance = parseInt(userRow[balanceCol]) || 0;
        const userName = userRow[nameCol] || user.first_name || user.username;
        const staticId = userRow[staticIdCol] || '';

        const userData = { 
          username: tgUsername, 
          nickname: userName,
          id: user.id,
          balance: userBalance,
          staticId: staticId,
          rowIndex: userRowIndex + 1,
          balanceCol: balanceCol + 1
        };
        
        console.log('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', userData);
        localStorage.setItem('tg_auth', JSON.stringify(userData));
        showShop(userData);
        
      } catch (e) {
        console.error('–ü–æ–ª–Ω–∞—è –æ—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', e);
        showNotification('–ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó: ' + e.message, 'error');
        showAccessDenied();
      }
    }

    async function getSheetData(name) {
      try {
        const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${encodeURIComponent(name)}?key=${API_KEY}`;
        console.log('–ó–∞–ø—Ä–æ—Å –∫ Google Sheets:', url);
        const res = await axios.get(url);
        console.log('–û—Ç–≤–µ—Ç –æ—Ç Google Sheets:', res.data);
        return res.data.values || [];
      } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö:', error);
        if (error.response) {
          console.error('–°—Ç–∞—Ç—É—Å –æ—à–∏–±–∫–∏:', error.response.status);
          console.error('–î–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏:', error.response.data);
        }
        showNotification('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ Google Sheets. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.', 'error');
        return [];
      }
    }

    // ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ë–ê–õ–ê–ù–°–ê ====================
async function updateBalanceInSheets(userData, newBalance, productName, productPrice) {
  return new Promise(async (resolve) => {
    try {
      console.log('üîÑ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–ª–∞–Ω—Å—É –≤ Google Sheets...', {
        row: userData.rowIndex,
        col: userData.balanceCol,
        newBalance,
        user: userData.username
      });

      const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbww7QeRvGL-2s12oscpGunEWZqfBBWRic0w-as6Gvy6BTrBXTAQQQitgPxggZzOh9xm/exec'; // ‚Üê –í–°–¢–ê–í –°–Æ–î–ò –°–í–Ü–ô URL

      const response = await axios.post(SCRIPT_URL, {
        row: userData.rowIndex,
        col: userData.balanceCol,
        newValue: newBalance
      });

      if (response.data.success) {
        console.log('‚úÖ –ë–∞–ª–∞–Ω—Å —É—Å–ø—ñ—à–Ω–æ –æ–Ω–æ–≤–ª–µ–Ω–æ –≤ Google Sheets');
        showNotification(`–ü–æ–∫—É–ø–∫–∞ "${productName}" —É—Å–ø—ñ—à–Ω–∞! –ù–æ–≤–∏–π –±–∞–ª–∞–Ω—Å: ${newBalance} –±–∞–ª—ñ–≤`, 'success');
        resolve(true);
      } else {
        throw new Error(response.data.error);
      }
    } catch (error) {
      console.error('‚ùå –ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–ª–∞–Ω—Å—É:', error);
      showNotification(`–ü–æ–∫—É–ø–∫–∞ –ø—Ä–∏–π–Ω—è—Ç–∞, –∞–ª–µ –±–∞–ª–∞–Ω—Å –Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–æ. –ü–æ–≤—ñ–¥–æ–º –∞–¥–º—ñ–Ω–∞!`, 'warning');
      resolve(false); // –ê–ª–µ –ø–æ–∫—É–ø–∫–∞ –≤—Å–µ –æ–¥–Ω–æ "—É—Å–ø—ñ—à–Ω–∞" –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    }
  });
}

    function showShop(userData) {
      console.log('–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–∞–≥–∞–∑–∏–Ω –¥–ª—è:', userData);
      
      const loginSection = document.getElementById('login-section');
      const mainContent = document.getElementById('mainContent');
      const logoutBtn = document.getElementById('logout-btn');
      
      if (loginSection) loginSection.classList.add('hidden');
      if (mainContent) mainContent.classList.remove('hidden');
      if (logoutBtn) logoutBtn.classList.remove('hidden');

      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∞–ª–∞–Ω—Å –∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      const balanceElement = document.getElementById('user-balance');
      if (balanceElement) {
        balanceElement.textContent = userData.balance || 0;
      }
      
      showNotification(`–í—ñ—Ç–∞—î–º–æ, ${userData.nickname}! –í–∞—à –±–∞–ª–∞–Ω—Å: ${userData.balance} –±–∞–ª—ñ–≤`, 'success');
      
      loadProducts();
    }

    function showAccessDenied() {
      const accessDeniedSection = document.getElementById('access-denied-section');
      const loginSection = document.getElementById('login-section');
      
      if (accessDeniedSection) accessDeniedSection.classList.remove('hidden');
      if (loginSection) loginSection.classList.add('hidden');
    }

    function logout() {
      localStorage.removeItem('tg_auth');
      location.reload();
    }

    // ==================== –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å–µ—Å—ñ—ó ====================
    document.addEventListener('DOMContentLoaded', async () => {
      const auth = localStorage.getItem('tg_auth');
      if (auth) {
        try {
          const user = JSON.parse(auth);
          showShop(user);
        } catch (e) { 
          console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏:', e);
          logout(); 
        }
      }
    });

    // ==================== –î–ê–ù–Ü –¢–û–í–ê–†–Ü–í ====================
    const products = [
      { id: 1, name: "–ë–æ–ª–∏–¥", description: "–ï–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏–π —Å–ø–æ—Ä—Ç–∏–≤–Ω–∏–π –∞–≤—Ç–æ–º–æ–±—ñ–ª—å", price: 8440, category: "transport", stock: 1, image: null },
      { id: 2, name: "–î–∏–≤–∞–Ω", description: "–†–æ–∑–∫—ñ—à–Ω–∏–π –¥–∏–≤–∞–Ω –¥–ª—è –≤–∞—à–æ–≥–æ –±—É–¥–∏–Ω–∫—É", price: 9345, category: "transport", stock: 1, image: null },
      { id: 3, name: "–ö–æ–ª–æ–Ω–∫–∞ –º–∞—Ä—à–∞–ª", description: "–ü–æ—Ç—É–∂–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ –¥–ª—è —è–∫—ñ—Å–Ω–æ–≥–æ –∑–≤—É–∫—É", price: 1800, category: "accessories", stock: 1, image: null },
      { id: 4, name: "–°—É–º–∫–∞ –ï–ª—ñ—Ç", description: "–ï–ª—ñ—Ç–Ω–∞ —Å—É–º–∫–∞ –¥–ª—è –ø–æ–≤—Å—è–∫–¥–µ–Ω–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è", price: 839, category: "accessories", stock: 2, image: null },
      { id: 5, name: "–†—é–∫–∑–∞–∫ –ú—ñ–ª—ñ—Ç–∞—Ä—ñ", description: "–°—Ç–∏–ª—å–Ω–∏–π –≤—ñ–π—Å—å–∫–æ–≤–∏–π —Ä—é–∫–∑–∞–∫", price: 990, category: "accessories", stock: 1, image: null },
      { id: 6, name: "–ö—Ä–∏–ª–∞ –ê–Ω–≥–µ–ª", description: "–ï–ª–µ–≥–∞–Ω—Ç–Ω—ñ –∫—Ä–∏–ª–∞ –¥–ª—è –≤–∞—à–æ–≥–æ –æ–±—Ä–∞–∑—É", price: 724, category: "clothing", stock: 2, image: null },
      { id: 7, name: "–ü–ª–∞—Ç—Ç—è –ö–∞–π", description: "–ö—Ä–∞—Å–∏–≤–µ –ø–ª–∞—Ç—Ç—è –¥–ª—è –æ—Å–æ–±–ª–∏–≤–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤", price: 839, category: "clothing", stock: 2, image: null },
      { id: 8, name: "–ö–æ—Ñ—Ç–∞ –ö–æ—Ö–∞–Ω–Ω—è", description: "–ó–∞—Ç–∏—à–Ω–∞ –∫–æ—Ñ—Ç–∞ –∑ —Ä–æ–º–∞–Ω—Ç–∏—á–Ω–∏–º –¥–∏–∑–∞–π–Ω–æ–º", price: 524, category: "clothing", stock: 2, image: null },
      { id: 9, name: "–§—É—Ç–±–æ–ª–∫–∞ For all cases", description: "–£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∞ —Ñ—É—Ç–±–æ–ª–∫–∞ –Ω–∞ –≤—Å—ñ –≤–∏–ø–∞–¥–∫–∏ –∂–∏—Ç—Ç—è", price: 366, category: "clothing", stock: 1, image: null },
      { id: 10, name: "–®—Ç–∞–Ω–∏ –Ω–∞–π–∫", description: "–ö–æ–º—Ñ–æ—Ä—Ç–Ω—ñ —Å–ø–æ—Ä—Ç–∏–≤–Ω—ñ —à—Ç–∞–Ω–∏", price: 416, category: "clothing", stock: 1, image: null },
      { id: 11, name: "–¢–∞–∫—Ç–∏—á–Ω—ñ —á–µ—Ä–µ–≤–∏–∫–∏", description: "–ú—ñ—Ü–Ω—ñ —Ç–∞–∫—Ç–∏—á–Ω—ñ —á–µ—Ä–µ–≤–∏–∫–∏", price: 205, category: "clothing", stock: 1, image: null },
      { id: 12, name: "–ë—Ä—é–∫–∏", description: "–ö–ª–∞—Å–∏—á–Ω—ñ –±—Ä—é–∫–∏", price: 472, category: "clothing", stock: 1, image: null },
      { id: 13, name: "–ü–ª–∞—Ç—Ç—è –°–≤–µ—Ç—Ä", description: "–°—Ç–∏–ª—å–Ω–µ –ø–ª–∞—Ç—Ç—è-—Å–≤–µ—Ç—Ä", price: 582, category: "clothing", stock: 1, image: null },
      { id: 14, name: "–ü—ñ–∂–∞–º–∞ –í–µ–¥–º–µ–¥–∏–∫", description: "–ú–∏–ª—ñ –ø—ñ–∂–∞–º–∏ –∑ –≤–µ–¥–º–µ–¥–∏–∫–∞–º–∏", price: 814, category: "clothing", stock: 1, image: null },
      { id: 15, name: "–ë–æ—Ç—Ñ–æ—Ä—Ç–∏", description: "–ï–ª–µ–≥–∞–Ω—Ç–Ω—ñ –±–æ—Ç—Ñ–æ—Ä—Ç–∏", price: 450, category: "clothing", stock: 1, image: null },
      { id: 16, name: "–ú–∞—Å–∫–∞ —ñ–∫–ª–∞", description: "–°—Ç–∏–ª—å–Ω–∞ –º–∞—Å–∫–∞ –¥–ª—è –∞–Ω–æ–Ω—ñ–º–Ω–æ—Å—Ç—ñ", price: 433, category: "accessories", stock: 1, image: null },
      { id: 17, name: "–ë–æ—Ä–æ–¥–∞", description: "–°—Ç–∏–ª—å–Ω–∞ –±–æ—Ä–æ–¥–∞ –¥–ª—è –≤–∞—à–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞", price: 236, category: "accessories", stock: 1, image: null },
      { id: 18, name: "–†—é–∫–∑–∞–∫ –õ–∞–±—É–±—É", description: "–ú–æ–¥–Ω–∏–π —Ä—é–∫–∑–∞–∫ –≤—ñ–¥ –õ–∞–±—É–±—É", price: 1120, category: "accessories", stock: 1, image: null },
      { id: 19, name: "–ù—å—é—Ä–æ–∫–∏", description: "–°—Ç–∏–ª—å–Ω–µ –≤–∑—É—Ç—Ç—è –ù—å—é—Ä–æ–∫–∏", price: 216, category: "clothing", stock: 1, image: null },
      { id: 20, name: "–†—é–∫–∑–∞–∫ –ú—ñ–∫–∫—ñ", description: "–†—é–∫–∑–∞–∫ –∑ –¥–∏–∑–∞–π–Ω–æ–º –ú—ñ–∫–∫—ñ –ú–∞—É—Å–∞", price: 1633, category: "accessories", stock: 1, image: null },
      { id: 21, name: "–ö–æ–±—É—Ä–∞ –ú—ñ–Ω—ñ–º—É–º", description: "–ú—ñ–Ω—ñ–º–∞–ª—ñ—Å—Ç–∏—á–Ω–∞ –∫–æ–±—É—Ä–∞ –¥–ª—è –∑–±—Ä–æ—ó", price: 526, category: "accessories", stock: 1, image: null }
    ];

    // ==================== –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –¢–û–í–ê–†–Ü–í ====================
    function loadProducts(category = 'all') {
      const grid = document.getElementById('products-grid');
      if (!grid) {
        console.error('–≠–ª–µ–º–µ–Ω—Ç products-grid –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
      }
      
      grid.innerHTML = '';
      const filtered = category === 'all' ? products : products.filter(p => p.category === category);
      
      const auth = localStorage.getItem('tg_auth');
      const user = auth ? JSON.parse(auth) : null;
      const balance = user ? user.balance : 0;

      if (filtered.length === 0) {
        grid.innerHTML = '<div class="no-products">–¢–æ–≤–∞—Ä–∏ –≤ —Ü—ñ–π –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –≤—ñ–¥—Å—É—Ç–Ω—ñ</div>';
        return;
      }

      filtered.forEach(p => {
        const card = document.createElement('div');
        card.className = 'product-card';
        card.dataset.category = p.category;
        const canBuy = balance >= p.price && p.stock > 0;

        card.innerHTML = `
          <div class="product-image">
            ${p.image ? `<img src="${p.image}" alt="${p.name}" loading="lazy">` : `<div class="product-image-placeholder"><i class="fas fa-image"></i><span>–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—É</span></div>`}
          </div>
          <div class="product-info">
            <h3 class="product-name">${p.name}</h3>
            <p class="product-description">${p.description}</p>
            <div class="product-price"><span class="price">${p.price} –±–∞–ª—ñ–≤</span></div>
            <button class="buy-btn" data-id="${p.id}" ${!canBuy ? 'disabled' : ''}>
              <i class="fas fa-shopping-cart"></i>
              ${p.stock === 0 ? '–ù–µ–º–∞—î –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ' : !canBuy ? '–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –±–∞–ª—ñ–≤' : '–ö—É–ø–∏—Ç–∏'}
            </button>
          </div>
          ${p.stock < 5 ? `<div class="product-stock ${p.stock === 0 ? 'low' : ''}">${p.stock} –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ</div>` : ''}
        `;
        grid.appendChild(card);
      });

      document.querySelectorAll('.buy-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const product = products.find(p => p.id == btn.dataset.id);
          openPurchaseModal(product);
        });
      });
    }

    // ==================== –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û ====================
    let currentProduct = null;
    function openPurchaseModal(product) {
      currentProduct = product;
      const productNameModal = document.getElementById('product-name-modal');
      const productPriceModal = document.getElementById('product-price-modal');
      const purchaseModal = document.getElementById('purchase-modal');
      
      if (productNameModal) productNameModal.textContent = product.name;
      if (productPriceModal) productPriceModal.textContent = product.price;
      if (purchaseModal) purchaseModal.classList.add('active');
    }
    function closePurchaseModal() {
      const purchaseModal = document.getElementById('purchase-modal');
      if (purchaseModal) purchaseModal.classList.remove('active');
      currentProduct = null;
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    document.addEventListener('DOMContentLoaded', () => {
      const closeModal = document.getElementById('close-modal');
      const cancelPurchase = document.getElementById('cancel-purchase');
      const confirmPurchase = document.getElementById('confirm-purchase');
      
      if (closeModal) closeModal.onclick = closePurchaseModal;
      if (cancelPurchase) cancelPurchase.onclick = closePurchaseModal;
      if (confirmPurchase) confirmPurchase.onclick = confirmPurchaseHandler;
    });

    async function confirmPurchaseHandler() {
      if (!currentProduct) return;
      
      const auth = localStorage.getItem('tg_auth');
      const user = auth ? JSON.parse(auth) : null;
      if (!user) {
        showNotification('–ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –°–ø—Ä–æ–±—É–π—Ç–µ —É–≤—ñ–π—Ç–∏ –∑–Ω–æ–≤—É.', 'error');
        return;
      }

      const balance = user.balance;
      if (balance >= currentProduct.price) {
        const newBalance = balance - currentProduct.price;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –≤ localStorage
        user.balance = newBalance;
        localStorage.setItem('tg_auth', JSON.stringify(user));
        
        const balanceElement = document.getElementById('user-balance');
        if (balanceElement) {
          balanceElement.textContent = newBalance;
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –≤ —Å–∏—Å—Ç–µ–º–µ
        await updateBalanceInSheets(user, newBalance, currentProduct.name, currentProduct.price);

        const idx = products.findIndex(p => p.id === currentProduct.id);
        if (idx !== -1) {
          products[idx].stock--;
        }
        
        const activeCategory = document.querySelector('.category-btn.active');
        if (activeCategory) {
          loadProducts(activeCategory.dataset.category);
        }
        
        closePurchaseModal();
      } else {
        showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –±–∞–ª—ñ–≤ –¥–ª—è –ø–æ–∫—É–ø–∫–∏!', 'error');
        closePurchaseModal();
      }
    }

    // ==================== –ö–ê–¢–ï–ì–û–†–Ü–á ====================
    document.addEventListener('DOMContentLoaded', () => {
      const categoryButtons = document.querySelectorAll('.category-btn');
      categoryButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          categoryButtons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          loadProducts(btn.dataset.category);
        });
      });
    });

    // ==================== –°–ü–û–í–Ü–©–ï–ù–ù–Ø ====================
    function showNotification(message, type = 'success') {
      const existingNotifications = document.querySelectorAll('.notification');
      existingNotifications.forEach(notif => notif.remove());
      
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => notification.classList.add('show'), 100);
      
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => notification.remove(), 300);
      }, 5000);
    }

    // ==================== –ö–ù–û–ü–ö–ê –ù–ê–ì–û–†–£ ====================
    document.addEventListener('DOMContentLoaded', () => {
      const backToTop = document.getElementById('backToTop');
      if (backToTop) {
        window.addEventListener('scroll', () => {
          backToTop.classList.toggle('visible', window.pageYOffset > 300);
        });
        backToTop.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    });

    // ==================== –û–ë–†–û–ë–ö–ê –ü–û–ú–ò–õ–û–ö ====================
    window.addEventListener('error', (e) => {
      console.error('–ì–ª–æ–±–∞–ª—å–Ω–∞ –ø–æ–º–∏–ª–∫–∞:', e.error);
      showNotification('–°—Ç–∞–ª–∞—Å—è –Ω–µ–æ—á—ñ–∫—É–≤–∞–Ω–∞ –ø–æ–º–∏–ª–∫–∞. –°–ø—Ä–æ–±—É–π—Ç–µ –æ–Ω–æ–≤–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É.', 'error');
    });
  </script>
</body>
</html>
